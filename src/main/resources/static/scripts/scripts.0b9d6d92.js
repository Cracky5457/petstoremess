function isUndefinedOrNull(a){return void 0===a||null===a}function displayToastSuccess(a,b){var c=a.data;switch(a.status){case 200:1===c._status?c._successMessage&&c._successMessage.length>0&&b.success(c._successMessage.join("<br><br>"),"Succès",{allowHtml:!0}):c._warningMessage&&c._warningMessage.length>0&&b.warning("Le formulaire est invalide","Erreur");break;default:b.success("Status "+a.statusText,'Succès"')}}function displayToastError(a,b){var c=a.data;switch(a.status){case 400:case 401:case 404:case 405:b.error(c._errorMessage.join("<br><br>"),"Erreur",{allowHtml:!0});break;default:b.error(a.statusText,"Erreur")}}angular.module("petstoreFrontApp",["ngResource","ngRoute","ngSanitize","ui.bootstrap","ngTagsInput","ngFileUpload","smart-table","toastr"]).constant("CONSTANTS",function(){return{USERS_DOMAIN:"",SUFFIXE_DOMAIN:".do",PET_STATUS:["Available","Pending","Sold"],STATE_VIEW:"View",STATE_EDIT:"Edit",STATE_ADD:"Add"}}()).config(["$routeProvider","$locationProvider","$httpProvider",function(a,b,c){b.hashPrefix(""),c.interceptors.push("responseObserver"),a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).when("/login",{templateUrl:"views/login.html",controller:"LoginCtrl",controllerAs:"login"}).otherwise({redirectTo:"/"})}]),angular.module("petstoreFrontApp").factory("responseObserver",["$q","$location","$injector","$window","toastr",function(a,b,c,d,e){return{responseError:function(c){switch(console.log("observer"),c.status){case 401:b.path("login");break;case 400:case 403:case 404:case 500:displayToastError(c,e)}return a.reject(c)}}}]),function(){"use strict";angular.module("petstoreFrontApp").controller("ModalConfirmCtrl",["$uibModalInstance","items",function(a,b){var c=this;this.title=b.title,this.message=b.message,this.init=function(){},this.ok=function(){a.close("ok")},this.cancel=function(){a.dismiss("cancel")},a.opened.then(function(){c.init()})}])}(),angular.module("petstoreFrontApp").controller("ModalPetCtrl",["$uibModalInstance","CONSTANTS","PetsApiFactory","items",function(a,b,c,d){var e=this;this.state,this.status=b.PET_STATUS,this.petModel={id:null,category:{id:null,name:""},name:"",photoUrls:[],tags:[],status:""},this.init=function(){null!=d.pet&&(this.petModel=d.pet),this.state=d.state},this.isViewMode=function(){return this.state===b.STATE_VIEW},this.getOkButton=function(){return this.state===b.STATE_VIEW?"Close":"Save"},this.ok=function(){a.close(this.petModel)},this.cancel=function(){a.dismiss("cancel")},a.opened.then(function(){e.init()})}]),angular.module("petstoreFrontApp").controller("ModalUploadFileCtrl",["$uibModalInstance","Upload",function(a,b){var c=this;this.file=null,this.init=function(){},this.ok=function(){a.close(this.file)},this.cancel=function(){a.dismiss("cancel")},a.opened.then(function(){c.init()})}]),angular.module("petstoreFrontApp").controller("MainCtrl",["CONSTANTS","$uibModal","PetsApiFactory","Upload",function(a,b,c,d){var e=this;this.displayListPets=[],this.listPets=[],this.lineByPage=5,this.init=function(){this.loadPets()},this.loadPets=function(){c.list().then(function(a){isUndefinedOrNull(a)||(e.listPets=a,e.displayListPets=a)},function(a){})},this.displayTags=function(a){var b="",c=0;if(!isUndefinedOrNull(a))for(c=0;c<a.length;c++)console.log(a[c]),b+=0==c?a[c].name:","+a[c].name;return b},this.addPet=function(){b.open({animation:!0,templateUrl:"views/modals/pet.html",controller:"ModalPetCtrl",controllerAs:"pet",size:"lg",resolve:{items:function(){return{state:a.STATE_ADD}}}}).result.then(function(a){c.save(a).then(function(a){e.loadPets()},function(a){})})},this.viewPet=function(c){b.open({animation:!0,templateUrl:"views/modals/pet.html",controller:"ModalPetCtrl",controllerAs:"pet",size:"lg",resolve:{items:function(){return{state:a.STATE_VIEW,pet:c}}}})},this.editPet=function(d){b.open({animation:!0,templateUrl:"views/modals/pet.html",controller:"ModalPetCtrl",controllerAs:"pet",size:"lg",resolve:{items:function(){return{state:a.STATE_EDIT,pet:d}}}}).result.then(function(a){c.save(a).then(function(a){e.loadPets()},function(a){})})},this.addImage=function(c){b.open({animation:!0,templateUrl:"views/modals/uploadfile.html",controller:"ModalUploadFileCtrl",controllerAs:"uploadfile",size:"lg"}).result.then(function(b){d.upload({url:a.USERS_DOMAIN+"/pet/"+c.id+"/uploadImage",file:b}).progress(function(a){}).success(function(a,b,c,d){e.loadPets()})})},this.removePet=function(a){b.open({animation:!0,templateUrl:"views/modals/modalConfirm.html",controller:"ModalConfirmCtrl",controllerAs:"modalconfirm",resolve:{items:function(){return{title:"Delete pet",message:"Are you sure you want to delete this pet ?"}}}}).result.then(function(){c.delete(a).then(function(){e.loadPets()})})}}]),angular.module("petstoreFrontApp").controller("MenuCtrl",["$location",function(a){this.menus={home:"",about:"",login:""},this.clickMenu=function(a){this.menus={home:"",about:"",login:""},this.menus[a]="active"},this.init=function(){var b=a.url();"/"==b?this.menus.home="active":"/about"==b?this.menus.about="active":"/login"==b&&(this.menus.login="active")}}]),angular.module("petstoreFrontApp").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("petstoreFrontApp").factory("userApiFactory",["CONSTANTS","$http",function(a,b){return{login:function(c,d){return b.get(a.USERS_DOMAIN+"/user/login"+a.SUFFIXE_DOMAIN+"?user="+c+"&password="+d).then(function(a){return a})}}}]),angular.module("petstoreFrontApp").factory("PetsApiFactory",["$http","CONSTANTS",function(a,b){return{save:function(c){return a.post(b.USERS_DOMAIN+"/pet"+b.SUFFIXE_DOMAIN,c).then(function(a){return a.data},function(a){return console.log(a),a})},delete:function(c){return a.delete(b.USERS_DOMAIN+"/pet/"+c+b.SUFFIXE_DOMAIN).then(function(a){return a.data},function(a){return console.log(a),a})},list:function(){return a.get(b.USERS_DOMAIN+"/pet/list"+b.SUFFIXE_DOMAIN).then(function(a){return a.data},function(a){return console.log(a),a})}}}]),angular.module("petstoreFrontApp").controller("LoginCtrl",["$location","userApiFactory",function(a,b){this.username="",this.password="",this.login=function(){b.login(this.username,this.password).then(function(b){console.log("reload"),a.path("/")},function(a){console.log("bad credentials"),console.log(a)})}}]),angular.module("petstoreFrontApp").run(["$templateCache",function(a){"use strict";a.put("views/about.html","<p>This is the about view.</p> "),a.put("views/main.html",'<div ng-init="main.init()" class="control"> <div class="row action-bar"> <div class="col-xs-12"> <button class="btn btn-primary" type="button" ng-click="main.addPet()"><span><i class="fa fa-plus" aria-hidden="true"></i> Add Pet</span></button> </div> </div> <div class="row"> <div class="col-xs-12"> <table st-table="main.displayListPets" st-safe-src="main.listPets" class="table table-striped table-no-border"> <thead> <tr> <th class="sortable" st-sort="name">Name</th> <th class="sortable" st-sort="status">Status</th> <th class="sortable" st-sort="category">Category</th> <th class="sortable" st-sort="tags">Tags</th> <th>Actions</th> </tr> <tr> <th> <input st-search="name" placeholder="name" class="input-sm form-control" type="search"> </th> <th> <input st-search="status" placeholder="status" class="input-sm form-control" type="search"> </th> <th> <input st-search="category.name" placeholder="category" class="input-sm form-control" type="search"> </th> <th> <input st-search="tags" placeholder="tags" class="input-sm form-control" type="search"> </th> <th></th> </tr> </thead> <tbody> <tr ng-show="main.displayListPets == null || main.displayListPets.length == 0"> <td colspan="5"> Pas de données </td> </tr> <tr ng-repeat="pet in main.displayListPets"> <td> <span ng-if="pet.photoUrls != null && pet.photoUrls.length > 0"> <img style="width:30px" ng-src="{{pet.photoUrls[0]}}"> </span> {{pet.name}} </td> <td>{{pet.status}}</td> <td>{{pet.category.name}}</td> <td>{{main.displayTags(pet.tags)}}</td> <td> <i class="fa fa-trash clickable" ng-click="main.removePet(54)" aria-hidden="true"></i> <i class="fa fa-eye clickable" ng-click="main.viewPet(pet)" aria-hidden="true"></i> <i class="fa fa-pencil-square-o clickable" ng-click="main.editPet(pet)" aria-hidden="true"></i> <i class="fa fa-file-image-o clickable" ng-click="main.addImage(pet)" aria-hidden="true"></i> </td> </tr> </tbody> <tfoot> <tr> <td colspan="5" class="text-center"> <div st-pagination="" st-items-by-page="main.lineByPage" st-template="views/partials/pagination.html"></div> </td> </tr> </tfoot> </table> </div> </div> </div>'),a.put("views/modals/modalConfirm.html",'<div> <div class="modal-header"> <span class="widget-header__title">{{modalconfirm.title}}</span> <i class="clickable fa fa-times fa-2x pull-right color-primary" aria-hidden="true" ng-click="retardlivraison.ok()"></i> </div> <div class="modal-body"> {{modalconfirm.message}} </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-click="modalconfirm.ok()">Yes</button> <button class="btn btn-primary" type="button" ng-click="modalconfirm.cancel()">Cancel</button> </div> </div> '),a.put("views/modals/pet.html",'<div ng-init="pet.init()" class="control"> <div class="modal-header"> <span class="modal-title">{{pet.state}} Pet</span> <i class="clickable fa fa-times fa-2x pull-right color-primary" aria-hidden="true" ng-click="pet.cancel()"></i> </div> <div class="modal-body"> <form> <fieldset ng-disabled="pet.isViewMode()"> <div class="form-group"> <label for="name">Name</label> <input type="text" class="form-control" id="name" placeholder="Name" ng-model="pet.petModel.name"> </div> <div class="form-group"> <label for="status">Status</label> <select class="form-control" ng-options="status for status in pet.status" ng-model="pet.petModel.status"></select> </div> <div class="form-group"> <label for="category">Category</label> <input type="text" class="form-control" id="category" placeholder="category" ng-model="pet.petModel.category.name"> </div> <div class="form-group"> <label for="tags">Tags</label> <tags-input ng-model="pet.petModel.tags" display-property="name"></tags-input> </div> <div class="row" ng-show="pet.petModel.photoUrls != null && pet.petModel.photoUrls.length > 0"> <div class="col-sm-6 col-md-3" ng-repeat="photo in pet.petModel.photoUrls"> <div class="thumbnail"> <img ng-src="{{photo}}"> </div> </div> </div> </fieldset> </form> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-click="pet.ok()">{{pet.getOkButton()}}</button> <button ng-show="!pet.isViewMode()" class="btn btn-primary" type="button" ng-click="pet.cancel()">Cancel</button> </div> </div> '),a.put("views/modals/uploadfile.html",'<div ng-init="uploadfile.init()" class="control"> <div class="modal-header"> <span class="modal-title">Upload file</span> <i class="clickable fa fa-times fa-2x pull-right color-primary" aria-hidden="true" ng-click="uploadfile.cancel()"></i> </div> <div class="modal-body"> <form> <div class="form-group"> <label for="image">Image</label> <br> <div class="btn btn-primary" ngf-select ng-model="uploadfile.file" name="file" ngf-pattern="\'image/*\'" ngf-accept="\'image/*\'" ngf-max-size="20MB" ngf-resize="{width: 200}">Select</div> <br><br> <div class="thumbnail" ng-show="uploadfile.file != null" style="width:200px"> <img ngf-src="uploadfile.file" ngf-resize="{width: 200, quality: 0.9}" ngf-no-object-url="true or false"> </div> </div> </form> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-click="uploadfile.ok()">Sauvegarder</button> <button class="btn btn-primary" type="button" ng-click="uploadfile.cancel()">Annuler</button> </div> </div> '),a.put("views/partials/pagination.html",'<div class="pagination" ng-if="pages.length >= 2"> <ul class="pagination"> <li> <a class="clickable" ng-click="selectPage(1)" aria-label="First"> <span aria-hidden="true">Début</span> </a> </li> <li> <a><i class="clickable fa fa-arrow-left" ng-click="selectPage(currentPage-1)" aria-hidden="true"></i></a> </li> <li ng-repeat="page in pages" ng-class="{active: page==currentPage}"><a class="clickable" ng-click="selectPage(page)">{{page}}</a></li> <li> <a><i class="clickable fa fa-arrow-right" ng-click="selectPage(currentPage+1)" aria-hidden="true"></i></a> </li> <li> <a class="clickable" href="" ng-click="selectPage(numPages)" aria-label="Last"> <span aria-hidden="true">{{numPages}}</span> </a> </li> </ul> </div>')}]);